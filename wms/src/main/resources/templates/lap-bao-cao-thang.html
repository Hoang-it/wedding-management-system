<!DOCTYPE HTML>
<html>
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
  <th:block th:insert="~{index :: libs}"></th:block>
	<title>BÁO CÁO DOANH SỐ </title>
</head>
<body class="nav-md">
    <th:block th:insert="~{index :: menu-bar}"></th:block>

    <div class="container body">
        <div class="main_container">              
          <!-- page content -->
          <div class="right_col" role="main">
            <div class="">
              <div class="page-title">
              <div class="title_left">
                <h3 style="color:black">BÁO CÁO DOANH SỐ</h3>
              </div>        
              <div class="title_right">
              </div>
              </div>
              <div class="clearfix"></div>
              <div class="row" style="color:black">
                <div class="col-md-12 col-sm-12 ">
                  <div class="x_panel">
                  <div class="x_title">
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <br>
                    <div class="item form-group">
                      <label class="col-form-label col-md-3 col-sm-3 label-align" for="thang" >Tháng <span class="required">*</span>
                      </label> 
                      <div class="col-md-6 col-sm-6 ">
                        <input type="number" class="form-control" id="thang" placeholder="Nhập tháng" required="required"> 
                      </div>
                    </div>
                    <div class="item form-group">
                      <label class="col-form-label col-md-3 col-sm-3 label-align" for="nam">Năm <span class="required">*</span>
                      </label>
                      <div class="col-md-6 col-sm-6 ">
                        <input type="number" class="form-control" id="nam" placeholder="Nhập năm" required="required"> 
                      </div>
                    </div>
                    <div class="ln_solid"></div>
                    <div class="item form-group">
                      <div class="col-md-6 col-sm-6 offset-md-3">
                      <button class="btn btn-success" type="submit" id="xem" >Xem</button>
                      </div>
                    </div>
                    <!-- </form> -->
                  </div>
                  </div>
                </div>
              </div>
                 
                  <div class="col-md-12 col-sm-12 ">
                    <div class="x_panel">
                    <div class="x_title">
                      <h3 style="color:black">Doanh Thu Theo Ngày</h3>
                      <ul class="nav navbar-right panel_toolbox">
                      </ul>
                      <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                      <div class="row">
                        <div class="col-sm-12">
                          <div class="card-box table-responsive">
                        <table id="table_id" class="table table-striped table-bordered" style="width:100%">
                          <caption><h5 style="color:black">Tổng doanh thu : </h5><span id="tongDoanhThu"></span></caption>
                          <thead style="color:black">
                            <tr>
                            <th>STT</th>
                            <th>Ngày</th>
                            <th>Số lượng tiệc cưới</th>
                            <th>Doanh Thu</th>
                            <th>Tỉ lệ</th>
                            </tr>
                          </thead>
                        <tbody style="color:black" id="dsDoanhThuNgay">                       
                        </tbody>  
                      </table>
                    </div>
                    </div>
                  </div>
                  </div>
                    </div>
                  </div>
                    </div>
                  </div>
                </div>
                <footer>
                  <div class="pull-right">                 
                  </div>
                  <div class="clearfix"></div>
                </footer>
                <!-- /footer content -->
              </div>
            </div>
            <th:block th:insert="~{index :: jsfiles}"></th:block>

            <!-- Datatables -->
            <script src="../vendors/datatables.net/js/jquery.dataTables.min.js"></script>
            <script src="../vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
            <script src="../vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
            <script src="../vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
            <script src="../vendors/datatables.net-buttons/js/buttons.flash.min.js"></script>
            <script src="../vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
            <script src="../vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
            <script src="../vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
            <script src="../vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
            <script src="../vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
            <script src="../vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
            <script src="../vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>
            <script src="../vendors/jszip/dist/jszip.min.js"></script>
            <script src="../vendors/pdfmake/build/pdfmake.min.js"></script>
            <script src="../vendors/pdfmake/build/vfs_fonts.js"></script>
    <script>
      var table = $('#table_id').DataTable()
      $("#xem").click(function(){
        alert("http://localhost:8080/api/ds-doanh-thu-ngay?thang=" + $("#thang").val() + "&nam=" + $("#nam").val())
        $.get("http://localhost:8080/api/ds-doanh-thu-ngay?thang=" + $("#thang").val() + "&nam=" + $("#nam").val(), function(data){
          table.clear()
          $.each(data, function(index, d){
              //alert(JSON.stringify(d))
              table.row.add( [
                  null,
                  d.ngay,
                  d.soLuongTiecCuoi,  
                  d.doanhThuNgay,
                  (d.tiLe * 100 ) + "%"                                        
              ] ).draw( false );
                              
          }) 
          table.on( 'order.dt search.dt', function () {
            table.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
                cell.innerHTML = i+1;
            } );
          } ).draw();  
          // $("#dsDoanhThuNgay").empty()
          // $.each(data, function(index, d){
          //   $("#dsDoanhThuNgay").append($("<tr>", {
          //     "id": "row-" + index
          //   }))
          //   $("#row-" + index).append($("<td>", {
          //     text: index
          //   }))
          //   $("#row-" + index).append($("<td>", {
          //     text: d.ngay
          //   }))
          //   $("#row-" + index).append($("<td>", {
          //     text: d.soLuongTiecCuoi
          //   }))
          //   $("#row-" + index).append($("<td>", {
          //     text: d.doanhThuNgay
          //   }))
          //   $("#row-" + index).append($("<td>", {
          //     text: (d.tiLe * 100 ) + "%"
          //   }))
          // })

          $.get("http://localhost:8080/api/tong-doanh-thu?thang=" + $("#thang").val() + "&nam=" + $("#nam").val(), function(data){
            $("#tongDoanhThu").text(data)
          })
        })
      })
    </script>
    </div>


</body>
</html>